<script>
export default {
  data(){
    return{
      message:"My First Vue app",
      todos:[],
      task:"",
      search:"",
      total:0,
      show:false
    }
  },
  methods:{
    addTask(e){
      e.preventDefault();
      const data = {
        task:this.task,
        status:false
      }
      this.todos.push(data)
      this.task=""
      console.log(this.todos)
    },
    fetchSomething(){
      const obj = [
        {task:"Eat after class",status:false},
        {task:"study after class",status:false},
        {task:"sleep after class",status:true}
      ]
      this.todos=obj;
      console.log(this.todos)
    },
    deleteTask(index){
      this.todos.splice(index,1)
    },
    markAsDone(todo){
      todo.status=!todo.status
    },
    showForm(){
      this.show = !this.show
    }
  },
  mounted() {
    this.fetchSomething()
  },
  computed:{
    filterTodos(){
      return this.todos.filter(todo=>{
        return todo.task.toLowerCase().includes(this.search.toLowerCase())
      })
    },
    countTodos(){
      return this.total = this.todos.length
    }
  }

}
</script>

<template>
  <div>
    <h1>{{ message }}</h1>
    <button @click="showForm">show</button>
    <form class="form" @submit="addTask" v-if="show">
      <input type="text" v-model="task" placeholder="add task..." required>
      <button type="submit">Add</button>
    </form>
    <div v-else>
      <p>No form shown</p>
    </div>
    <p>Total todos: {{ countTodos }}</p>
    <input type="text" placeholder="search task" v-model="search">
    <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Task</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="todo,index in filterTodos" :class="todo.status ? 'done':''">
            <td>{{ index }}</td>
            <td>{{ todo.task }}</td>
            <td>{{ todo.status }}</td>
            <td>
              <button @click="deleteTask(index)">Delete</button><button @click="markAsDone(todo)">Done</button>
            </td>
          </tr>
        </tbody>
    </table>
  </div>
</template>

<style>
.form{
  border:1px solid;
  padding:10px;
  width: 200px;
  display: flex;
  justify-content: center;
}
table,tr,td,th{
  border:1px solid;
}
.done{
  background-color: rgb(160, 220, 160);
}

</style>
